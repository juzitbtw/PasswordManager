
# Password Manager

**Безопасное хранилище паролей с шифрованием на основе AES‑GCM и защитой мастер‑паролем.**

## Описание


Программа позволяет:
- хранить учётные данные (место, логин, пароль);
- шифровать данные с использованием AES‑256 в режиме GCM;
- защищать доступ мастер‑паролем;
- проверять целостность данных через хэши SHA3‑256;
- изменять мастер‑пароль с перешифрованием всех данных.

## Архитектура

Проект состоит из следующих ключевых классов:


### AESEncryption
- реализует шифрование/дешифрование полей и ключей;
- использует AES‑256/GCM без дополнения;
- генерирует IV и соль;
- поддерживает двойное шифрование (ключи + данные).

### Constants
- содержит константы конфигурации;
- хранит имя файла хранилища;
- задаёт длины ключей, IV, тегов GCM;
- определяет количество итераций для PBKDF2;
- содержит значения по умолчанию для полей.

### KeyDeriver
- отвечает за генерацию ключей;
- создаёт соль;
- выводит ключ из мастер‑пароля через `PBKDF2WithHmacSHA3‑512`.

### PasswordEntry
- модель одной записи;
- хранит место, логин, пароль;
- содержит хэши для проверки целостности;
- управляет солью и ключом шифрования.

### PasswordManager
- реализует бизнес‑логику приложения;
- обеспечивает загрузку/сохранение записей в файл;
- поддерживает добавление, удаление, редактирование записей;
- выполняет проверку целостности данных;
- осуществляет перешифрование при смене мастер‑пароля.

### PasswordManagerUI
- представляет пользовательский интерфейс;
- реализует консольное меню;
- обеспечивает ввод/вывод данных;
- обрабатывает ошибки.


### Main
- точка входа в приложение;
- инициализирует провайдера Bouncy Castle;
- запускает UI.

## Требования

- Java 8 или выше;
- библиотека Bouncy Castle (для SHA3 и `PBKDF2WithHmacSHA3‑512`).

## Использование

### Запуск программы


При старте введите мастер‑пароль:
Введите мастер-пароль:

- Если файл хранилища `mineSecurePasswords.txt` отсутствует, он будет создан автоматически.
- При неверном пароле даётся 3 попытки, после чего программа завершается.

### Главное меню

#### После успешной авторизации отображается меню:

1. Добавить запись

2. Удалить запись

3. Просмотреть все записи

4. Получить конкретную запись

5. Редактировать запись

6. Изменить мастер‑пароль

7. Проверить целостность данных

8. Выйти

Выберите действие:


### Добавление записи

1. Выберите пункт **1. Добавить запись**.
2. Введите:
   - место (адрес сервиса);
   - логин;
   - пароль.
3. Подтвердите действие (`Y` / `N`).


**Результат:** запись зашифруется и сохранится в файл.

### Удаление записи
1. Выберите пункт **2. Удалить запись**.
2. Укажите номер записи из списка.
3. Подтвердите удаление (`Y` / `N`).


**Результат:** запись удалится, данные сохранятся.


### Просмотр записей
- **Пункт 3. Просмотреть все записи**  
  Выводит список в формате:  
номер: место — логин


- **Пункт 4. Получить конкретную запись**  
1. Введите номер записи.  
2. Программа покажет полные данные: место, логин, пароль.


### Редактирование записи
1. Выберите пункт **5. Редактировать запись**.
2. Укажите номер записи.
3. Выберите поле для изменения:
 - `1` — место;
 - `2` — логин;
 - `3` — пароль;
 - `4` — все поля;
 - `5` — отмена.
4. Введите новые значения.
5. Подтвердите изменения (`Y` / `N`).


**Результат:** данные обновятся и сохранятся.

### Смена мастер‑пароля
1. Выберите пункт **6. Изменить мастер‑пароль**.
2. Введите текущий мастер‑пароль.
3. Введите новый мастер‑пароль.
4. Подтвердите новый пароль.
5. Программа перешифрует все данные с новым ключом.


**Важно:**
- все записи будут повторно зашифрованы;
- временный файл создаётся для безопасности; после успеха он заменит оригинал.


### Проверка целостности данных
1. Выберите пункт **7. Проверить целостность данных**.
2. Программа:
 - расшифрует записи;
 - сравнит хэши SHA3‑256 сохранённых и текущих данных.
3. Результаты:
 - если хэши совпадают — вывод: «Целостность подтверждена»;
 - если не совпадают — сообщение об ошибке с указанием поля.


### Выход из программы
Выберите пункт **8. Выйти** для завершения работы.


## Формат хранения данных


**Файл:** `mineSecurePasswords.txt`.


**Структура:**
1. Первая строка — закодированная в Base64 соль (16 байт).
2. Последующие строки — зашифрованные записи в формате:  
зашифрованные_данные,зашифрованный_ключ_1,зашифрованный_ключ_2

где:
- `зашифрованные_данные` — Base64‑строка с зашифрованными полями и хэшами;
- `зашифрованный_ключ_1` — ключ для полей;
- `зашифрованный_ключ_2` — ключ для всей строки.


## Безопасность
- **Шифрование:** AES‑256/GCM (надёжный режим с аутентификацией).
- **Вывод ключа:** `PBKDF2WithHmacSHA3‑512` (500 000 итераций).
- **Соль:** 16 байт, уникальна для каждого хранилища.
- **Хэши:** SHA3‑256 для проверки целостности полей.
- **IV:** 12 байт, генерируется случайно для каждого шифрования.
- **Теги GCM:** 128 бит для аутентификации шифротекста.


## Ошибки и обработка исключений
- **Неверный мастер‑пароль:** до 3 попыток, затем завершение работы.
- **Ошибки шифрования/дешифрования:** логируются в `System.err`.
- **Некорректный формат файла:** данные не загружаются, выводится сообщение об ошибке.
- **Проблемы с файлом** (нет доступа, не найден): обрабатываются через `IOException`, предлагается создать новый файл.
- **Несовпадение хэшей при проверке целостности:** выводится предупреждение с указанием поля, запись остаётся в хранилище.


## Конфигурация (Constants.java)


| Параметр | Значение | Описание |
| --- | --- | --- |
| `FILE_NAME` | `mineSecurePasswords.txt` | Имя файла хранилища |
| `SALT_SIZE` | `16` | Размер соли (байт) |
| `ITERATIONS` | `500_000` | Итерации PBKDF2 |
| `KEY_SIZE` | `256` | Размер ключа (бит) |
| `IV_LENGTH` | `12` | Длина IV (байт) |
| `GCM_TAG_LENGTH` | `128` | Длина тега GCM (бит) |
| `MAX_ATTEMPTS` | `3` | Попыток ввода пароля |
| `DEFAULT_PLACE` | `[Нет адреса]` | Значение по умолчанию для места |
| `DEFAULT_LOGIN` | `[Нет логина]` | Значение по умолчанию для логина |
| `DEFAULT_PASSWORD` | `[Нет пароля]` | Значение по умолчанию для пароля |


## Примечания
- Для работы с SHA3 и PBKDF2 требуется **Bouncy Castle**.
- Данные шифруются **дважды** для повышения безопасности.
- Хэши хранятся **вместе с данными** для проверки целостности.